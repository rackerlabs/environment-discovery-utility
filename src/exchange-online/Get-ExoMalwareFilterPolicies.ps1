function Get-ExoMalwareFilterPolicies
{
    <#

        .SYNOPSIS
            Discover Exchange Online Malware Filter Policies

        .DESCRIPTION
            Query Exchange Online for configured Exchange Online Malware Filter Policies

        .OUTPUTS
            Returns a custom object containing configured Exchange Online Malware Filter Policies

        .EXAMPLE
            Get-ExoMalwareFilterPolicies

    #>

    [CmdletBinding()]
    param ()

    $activity = "Exchange Online Malware Filter Policies"
    $discoveredMalwareFilterPolicies = @()

    try
    {
        Write-Log -Level "INFO" -Activity $activity -Message "Query Exchange Online for malware filter policies." -WriteProgress
        $malwareConfigPolicies = Get-MalwareFilterPolicy
        $properties = $malwareConfigPolicies | Get-Member | Where-Object {$_.MemberType -like "Property" -and $_.Definition -like "System.*"} | Select-Object -ExpandProperty Name

        foreach ($malwareConfigPolicy in $malwareConfigPolicies)
        {
            $policy = $malwareConfigPolicy | Select-Object $properties
            $discoveredMalwareFilterPolicies += $policy
        }
    }
    catch
    {
        Write-Log -Level "ERROR" -Activity $activity -Message "Failed to query Exchange Online for malware filter policies. $($_.Exception.Message)"
        return
    }

    $discoveredMalwareFilterPolicies
}
